generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model admin {
  id       Int        @id @default(autoincrement())
  name     String     @db.VarChar(255)
  email    String     @unique(map: "Admin_email_key") @db.VarChar(255)
  password String     @db.VarChar(255)
  role     admin_role
}

model round {
  id           Int            @id @default(autoincrement())
  name         String
  qualifiers   Int?
  status       Boolean        @default(true)
  settings     settings[]
  user_session user_session[]
}

model settings {
  id            Int     @id @default(autoincrement())
  current_round Int
  status        Boolean @default(true)
  round         round   @relation(fields: [current_round], references: [id], map: "Settings_current_round_fkey")

  @@index([current_round], map: "current_id")
}

model user {
  id                Int            @id @default(autoincrement())
  name              String
  email             String?        @unique(map: "User_email_key") @db.VarChar(255)
  telephone         String?
  bio               String?
  regional_pastor   String?
  gender            String?
  age_grade         String?
  category          String?
  type              String?
  number_of_members Int            @default(1)
  country           String?
  state             String?
  region            String?
  province          String?
  picture           String?
  date              DateTime       @default(now())
  status            user_status    @default(registered)
  user_session      user_session[]
}

model user_session {
  id          Int                 @id @default(autoincrement())
  round_id    Int
  votes       Int                 @default(0)
  judge_votes Int                 @default(0)
  score       Int                 @default(0)
  user_id     Int
  status      user_session_status @default(pending)
  round       round               @relation(fields: [round_id], references: [id], map: "User_session_round_id_fkey")
  user        user                @relation(fields: [user_id], references: [id], map: "User_session_user_id_fkey")

  @@index([round_id], map: "round_id")
  @@index([user_id], map: "user_id")
}

enum admin_role {
  judge
  admin
}

enum user_session_status {
  voted
  skipped
  pending
}

enum user_status {
  registered
  approved
  disqualified
}
